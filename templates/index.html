<!DOCTYPE html>
<html>
    <head>
        <link href="/static/surface_styles.css" rel="stylesheet"/>
        <link href="/static/mystyle.css" rel="stylesheet"/>

        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Space+Mono&display=swap" rel="stylesheet"> 
    </head>
    <body class="bg--teal">
        <header class="bg--black container" style="box-shadow: 0 0 4px 0 rgba(0, 0, 0, 0.08), 0 2px 4px 0 rgba(0, 0, 0, 0.12);">
            <h1 class="m--1 g--6 color--paper">PubMed Search</h1>
        </header>
        <div id="content" class="center" style="width: 100%;">

            <div class="block center card bg--black g--6">
                <h3 class="card-title">Pull publications</h3>
                <div class="container center">
                    <div class="container center">
                        <div class="m--1">
                            <input class="monospaced" type="text" id="pubmed-pull" placeholder="Query"/>
                        </div>
                        <div class="m--1">
                            <button id="pull-query" class="btn--raised btn--primary" onclick="pubmedPull()">Pull</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="block center card bg--black g--6">
                <h3 class="card-title">Search</h3>
                <div class="container center">
                    <div class="container center">
                        <div class="m--1">
                            <select id="select-dataset">
                            </select>
                            <br>
                            <select id="select-search">
                                <option value="boolean">Boolean</option>
                                <option value="vector">Vector Space Model</option>
                                <option value="okapi">Okapi BM25</option>
                            </select>
                            <br>
                            <select id="select-fields">
                                <option value="all">All</option>
                                <option value="title">Title</option>
                                <option value="authors">Authors</option>
                                <option value="abstract">Abstract</option>
                                <option value="date">Date</option>
                            </select>
                            <br>
                            <div class="container">
                                <input type="radio" id="choice-stem" name="text-proc" value="stem" checked="checked" />
                                <label for="choice-stem">Stemming</label>
                                
                                <input type="radio" id="choice-lem" name="text-proc" value="lem"/>
                                <label for="choice-lem">Lemmatization</label>
                            </div>
                            <input id="search-query" class="monospaced" type="text" placeholder="Query"/>
                            <button onclick="pubmedSearch()" class="btn--raised btn--primary">Search</button>
                        </div>
                    </div>
                </div>
            </div>

            
        </div>
        <script>
            async function pubmedPull() {
                if (document.getElementById("pubmed-pull").value == "") {
                    alert("Please, fill-in the pull field.");
                    return true;
                }
                document.getElementById("pull-query").disabled = true;
                
                
                const query = document.getElementById("pubmed-pull").value;
                const filename = "data-" + Date.now();
                const url = "http://localhost:5000/get_data/" + query + "/" + filename;

                await fetch(url)
                    .then((response) => response.json())
                    .then((json) => console.log(json));

                // add option to list and don't reload
                
                location.reload();
                return false;
            }
        </script>
        <script>
            function pubmedSearch() {
                if (document.getElementById("search-query").value == "") {
                    alert("Please, fill-in the search field.");
                    return true;
                }

                var contentDiv = document.getElementById("content");
                var resultsDiv = document.getElementById("results");
                if (resultsDiv == null) {
                    resultsDiv = document.createElement("div");
                    resultsDiv.setAttribute("id", "results")
                    resultsDiv.classList.add("block","center", "card", "bg--black", "g--6");

                    var titleHeader = document.createElement("h3");
                    titleHeader.classList.add("card-title");
                    titleHeader.innerText = "Results";
                    resultsDiv.appendChild(titleHeader);

                    contentDiv.appendChild(resultsDiv);
                }
                
                // list get results

                return true;
            }
        </script>
        <script>
            var datasetSelect = document.getElementById("select-dataset");

            // get dataset list
            const array = ["data1", "data2"];

            for (var i = 0; i < array.length; i++) {
                var option = document.createElement("option");
                option.setAttribute("value", array[i]);
                option.text = array[i];
                datasetSelect.appendChild(option);
            }
        </script>
    </body>
</html>